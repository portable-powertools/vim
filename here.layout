VIM_PREFIX="$mod_vim_root/.local"
VIM_SW="$mod_vim_sw"

pyenv_is2 ()
{
    pyenv_version | grep '^2\.' > /dev/null
    return $?
}
pyenv_version() {
    pyenv version | linewise -s | firstPipe
}
setup_configure_cmd() {
    if [[ ! $mod_vim_root ]]; then
        log_error "mod_vim_root: '$mod_vim_root' not found, cant proceed"
        return 1
    fi
    
    if [[ ! -d "$VIM_PREFIX" ]]; then
        mkdir -p "$VIM_PREFIX"
    fi || { log_error no dir: $VIM_PREFIX; return 1; }

    local PREFIXFLAG="--prefix=$VIM_PREFIX"

    printf './configure \
    --with-features=huge \
    --enable-multibyte \
    --enable-pythoninterp \
    --enable-gui=gtk2 \
    --enable-cscope \
    $PREFIXFLAG $@"'
}
setup_complete() {
    local cmd="$(setup_configure_cmd)"
    (   set -e; 
        cd "$VIM_SW"
        echo "cmd: '$cmd'"
        echo "proceed?"
        if asksure; then
            eval "$cmd"
        else
            return 1
        fi
        
        echo "make?"
        if asksure; then
            make; make install;
        else
            return 1
        fi
        echo "make install?"
        if asksure; then
            make; make install;
        else
            return 1
        fi
    )
}
